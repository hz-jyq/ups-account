<?xml version="1.0" encoding="UTF8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.pgy.ups.account.business.dao.mapper.ProofreadErrorDao">

	<sql id="proofreadErrorColumn">
		id,
		fromSystem,
		proofreadType,
		DATE_FORMAT(proofreadDate,'%Y-%m-%d') as proofreadDate,
		businessOrderNum,
		borrowNum,
		businessExchangeMoney,
		businessOrderStatuts,
    	businessOrderCreateTime,
    	channel,
		channelExchangeMoney,
		channelOrderStatus,
		channelOrderCreateTime,
		DATE_FORMAT(disposeTime,'%Y-%m-%d %H:%i:%s') as disposeTime,
		errorType,
		flowStatus,
 		updateUser
	</sql>

	<insert id="batchInsert">
		INSERT INTO ua_t_account_proofreadError VALUES
		<foreach collection="list" item="item" separator=",">
		   (
			null,
			#{item.channel},
			#{item.fromSystem},
			#{item.proofreadType},
			#{item.proofreadDate},
			#{item.businessOrderNum},
			#{item.borrowNum},
			#{item.businessExchangeMoney},
			#{item.businessOrderStatuts},
			#{item.businessOrderCreateTime},
			#{item.channelExchangeMoney},
			#{item.channelOrderStatus},
			#{item.channelOrderCreateTime},
			#{item.disposeTime},
			#{item.errorType},
			#{item.flowStatus},
		    ''
		    )
		</foreach>
	</insert>

	<delete id="deleteProofreadError">
		DELETE FROM ua_t_account_proofreadError
		<where>
			<choose>
				<when test="fromSystem !=null and fromSystem!=''">
					fromSystem=#{fromSystem}
				</when>
				<otherwise>
					1=2
				</otherwise>
			</choose>
			<choose>
				<when test="proofreadType!=null and proofreadType!=''">
					AND proofreadType=#{proofreadType}
				</when>
				<otherwise>
					AND 1=2
				</otherwise>
			</choose>
			<choose>
				<when test="proofreadDate != null and proofreadDate!=''">
					AND proofreadDate=#{proofreadDate}
				</when>
				<otherwise>
					AND 1=2
				</otherwise>
			</choose>
			<choose>
				<when test="channel != null and channel!=''">
					AND channel=#{channel}
				</when>
				<otherwise>
					AND 1=2
				</otherwise>
			</choose>
		</where>
	</delete>

	<select id="getPage" resultType="proofreadError" parameterType="com.pgy.ups.account.facade.from.ProofreadErrorForm">
		  select <include refid="proofreadErrorColumn"/> from ua_t_account_proofreadError
		<where>
			<if test="errorType!=null and errorType!=''">
				and errorType = #{errorType}
			</if>
			<if test="proofreadDateStart !=null and proofreadDateStart! =''">
				and proofreadDate <![CDATA[>=]]> #{proofreadDateStart}
			</if>
			<if test="proofreadDateEnd !=null and proofreadDateEnd !=''">
				and proofreadDate <![CDATA[<=]]>  #{proofreadDateEnd}
			</if>
			<if test="channel!=null and channel!=''" >
				and channel = #{channel}
			</if>
			<if test="fromSystem!=null and fromSystem!=''" >
				and   fromSystem = #{fromSystem}
			</if>
			<if test="proofreadType!=null and proofreadType!=''" >
				and   proofreadType = #{proofreadType}
			</if>
			<if  test="flowStatus!=null and flowStatus!=''" >
				and   flowStatus = #{flowStatus}
			</if>
			<if test="businessOrderNum!=null and businessOrderNum!=''" >
				and   businessOrderNum = #{businessOrderNum}
			</if>
		</where>
	</select>

</mapper>